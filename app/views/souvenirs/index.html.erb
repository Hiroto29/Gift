<h1></h1>
<%= link_to "イチオシ一覧へ", souvenir_ichiosi_path %>
<h3>一覧ページ</h3>
<h4>投稿を検索</h4>
 <%= form_tag({controller:"souvenirs",action:"index"}, method: :get) do %>
   <%= select_tag  "prefecture", raw("<option>北海道</option>
   <option>青森県</option>
   <option>岩手県</option>
   <option>宮城県</option>
   <option>秋田県</option>
   <option>山形県</option>
   <option>福島県</option>
   <option>茨城県</option>
   <option>栃木県</option>
   <option>群馬県</option>
   <option>埼玉県</option>
   <option>千葉県</option>
   <option>東京都</option>
   <option>神奈川県</option>
   <option>新潟県</option>
   <option>富山県</option>
   <option>石川県</option>
   <option>福井県</option>
   <option>山梨県</option>
   <option>長野県</option>
   <option>岐阜県</option>
   <option>静岡県</option>
   <option>愛知県</option>
   <option>三重県</option>
   <option>滋賀県</option>
   <option>京都府</option>
   <option>大阪府</option>
   <option>兵庫県</option>
   <option>奈良県</option>
   <option>和歌山県</option>
   <option>鳥取県</option>
   <option>島根県</option>
   <option>岡山県</option>
   <option>広島県</option>
   <option>山口県</option>
   <option>徳島県</option>
   <option>香川県</option>
   <option>愛媛県</option>
   <option>高知県</option>
   <option>福岡県</option>
   <option>佐賀県</option>
   <option>長崎県</option>
   <option>熊本県</option>
   <option>大分県</option>
   <option>宮崎県</option>
   <option>鹿児島県</option>
   <option>沖縄県</option>
   ``` &#8203;``【oaicite:0】``&#8203;
   "), multiple: false %>
   <%= submit_tag '検索する'  %>
<% end %>

<%= link_to "お土産探しの旅", perfumes_path %>

<%= stylesheet_link_tag 'index', :media => "all" %>

<div class="souvenirs-container">
  <% @souvenirs.each do |t| %>
    <div class="souvenir">
      <%= image_tag t.image_url, size: "250x200" if t.image? %>
      <%= t.name %>
      <%= t.prefecture %>
      <%= t.adress %>
      <%= t.about %>
      <%= link_to "詳細へ", souvenir_path(t.id) %>
      <%= link_to "編集する", edit_souvenir_path(t.id) %>
      <%= button_to "削除する", souvenir_path(t.id), method: :delete %>
    </div>
    <p class="time"><%= t.created_at %></p>
  <% end %>
</div>


<h2>gmap</h2>
<div id='map'></div>

<style>
#map {
  height: 600px;
  width: 100%;
}
</style>

<!-- js部分 -->
<script>
function initMap() {

  //初期表示位置
  let latlng = new google.maps.LatLng(38.60, 139.5);
  //デザイン
  let styles = [
       {
        stylers: [
         { "saturation": 0 },
         { "lightness": 0 }
        ]
       }
      ];

  let map = new google.maps.Map(document.getElementById('map'), {
      zoom: 5.5,
      styles: styles,
      center: latlng
  });
  let transitLayer = new google.maps.TransitLayer();
  transitLayer.setMap(map);

//複数マーカー ここから
  <% @souvenirs.each do |souvenir|%>
    ( function() { 
      let markerLatLng = { lat: <%= souvenir.lat %>, lng: <%= souvenir.lng %> }; // 緯度経度のデータ作成
      let marker = new google.maps.Marker({ 
        position: markerLatLng, 
        map: map 
      });
//マーカーをクリックしたとき、詳細情報を表示
      let infowindow = new google.maps.InfoWindow({
        position: markerLatLng,
        content: "<a href='<%= souvenir_url(souvenir.id) %>' target='_blank'><%= souvenir.image %></a>"
      }); //ここで詳細ページへのリンクを表示させる
      marker.addListener('click', function() {
        infowindow.open(map, marker);
      });

   })();
  <% end %>
  //複数マーカー ここまで  
}
</script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBkxCV4XGBt1l8ID4gCPcOBXv-Ny71LwLE&callback=initMap" async defer></script>
